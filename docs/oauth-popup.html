<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="referrer" content="no-referrer" />
    <title>Signing in…</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="container">
      <p class="status">Completing GitHub sign-in…</p>
      <p class="hint">You can close this window if it doesn’t close automatically.</p>
    </main>

    <script>
      (function () {
        const hash = window.location.hash || '';
        const params = new URLSearchParams(hash.startsWith('#') ? hash.slice(1) : '');

        const payload = {
          type: 'org-catalog-oauth',
          accessToken: params.get('access_token') || null,
          error: params.get('error') || null,
          org: params.get('org') || null,
        };

        try {
          if (window.opener && window.opener !== window) {
            window.opener.postMessage(payload, window.location.origin);
          }
        } finally {
          // Best-effort close (may be blocked in some browsers)
          window.close();
        }
      })();
    </script>
  </body>
</html>
